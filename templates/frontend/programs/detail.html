{% extends 'frontend/base.html' %}
{% load static %}

{% block title %}{{ program.name }} | AIFA Football Academy{% endblock %}

{% block meta_description %}{{ program.short_description|default:program.description|truncatewords:25 }}{% endblock %}

{% block og_title %}{{ program.name }} | AIFA Football Academy{% endblock %}
{% block og_description %}{{ program.short_description|default:program.description|truncatewords:20 }}{% endblock %}
{% block og_image %}{% if program.image %}{{ program.image.url }}{% endif %}{% endblock %}

{% block content %}
<!-- Page Hero -->
<section class="page-hero">
    <div class="page-hero-bg" style="background-image: url('{% if program.image %}{{ program.image.url }}{% else %}https://images.unsplash.com/photo-1431324155629-1a6deb1dec8d?w=1920&q=80{% endif %}')"></div>
    <div class="page-hero-overlay"></div>
    <div class="page-hero-content">
        <div class="section-tag animate-on-scroll">{{ program.age_group|default:"All Ages" }}</div>
        <h1 class="page-hero-title animate-on-scroll">{{ program.name|upper }}</h1>
        <p class="page-hero-text animate-on-scroll">{{ program.short_description|default:program.description|truncatewords:20 }}</p>
    </div>
</section>

<!-- Program Quick Info Bar -->
<section class="program-info-bar">
    <div class="container">
        <div class="program-info-bar-inner">
            <a href="{% url 'programs:list' %}" class="program-back-link">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                All Programs
            </a>
            <div class="program-quick-stats">
                {% if program.sessions_per_week %}
                <div class="program-quick-stat">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                        <line x1="16" y1="2" x2="16" y2="6"/>
                        <line x1="8" y1="2" x2="8" y2="6"/>
                        <line x1="3" y1="10" x2="21" y2="10"/>
                    </svg>
                    <span>{{ program.sessions_per_week }}x/week</span>
                </div>
                {% endif %}
                {% if program.duration %}
                <div class="program-quick-stat">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 16 14"/>
                    </svg>
                    <span>{{ program.duration }}</span>
                </div>
                {% endif %}
                {% if program.fee_amount %}
                <div class="program-quick-stat highlight">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="1" x2="12" y2="23"/>
                        <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                    </svg>
                    <span>{{ program.fee_amount }}/{{ program.fee_period }}</span>
                </div>
                {% endif %}
            </div>
            <a href="{% url 'frontend:contact' %}" class="btn btn-primary">Enroll Now</a>
        </div>
    </div>
</section>

<!-- Program Details -->
<section class="section" id="program-details">
    <div class="container">
        <div class="program-detail-layout">
            <!-- Main Content -->
            <div class="program-detail-main">
                <!-- About Section -->
                <div class="program-section">
                    <h2 class="program-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <line x1="12" y1="16" x2="12" y2="12"/>
                            <line x1="12" y1="8" x2="12.01" y2="8"/>
                        </svg>
                        About This Program
                    </h2>
                    <div class="program-description">
                        {{ program.description|linebreaks }}
                    </div>
                </div>

                <!-- Features Section -->
                {% if program.features %}
                <div class="program-section">
                    <h2 class="program-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 11 12 14 22 4"/>
                            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                        </svg>
                        What You'll Learn
                    </h2>
                    <div class="program-features-grid">
                        {% for feature in program.features %}
                        <div class="program-feature-item">
                            <div class="program-feature-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="20 6 9 17 4 12"/>
                                </svg>
                            </div>
                            <span>{{ feature }}</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Batches Section -->
                {% if batches %}
                <div class="program-section">
                    <h2 class="program-section-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                        </svg>
                        Available Batches
                    </h2>
                    <div class="batches-grid">
                        {% for batch in batches %}
                        <div class="batch-card">
                            <div class="batch-header">
                                <h3 class="batch-name">{{ batch.name }}</h3>
                                <span class="batch-capacity {% if batch.current_strength >= batch.max_capacity %}full{% endif %}">
                                    {{ batch.current_strength }}/{{ batch.max_capacity }}
                                </span>
                            </div>
                            <div class="batch-details">
                                <div class="batch-detail-item">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"/>
                                        <polyline points="12 6 12 12 16 14"/>
                                    </svg>
                                    <span>{{ batch.start_time|time:"g:i A" }} - {{ batch.end_time|time:"g:i A" }}</span>
                                </div>
                                <div class="batch-detail-item">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                        <line x1="16" y1="2" x2="16" y2="6"/>
                                        <line x1="8" y1="2" x2="8" y2="6"/>
                                        <line x1="3" y1="10" x2="21" y2="10"/>
                                    </svg>
                                    <span>{{ batch.days }}</span>
                                </div>
                                <div class="batch-detail-item">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                        <circle cx="12" cy="10" r="3"/>
                                    </svg>
                                    <span>{{ batch.venue }}</span>
                                </div>
                                {% if batch.coach %}
                                <div class="batch-detail-item">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                        <circle cx="12" cy="7" r="4"/>
                                    </svg>
                                    <span>Coach {{ batch.coach.first_name }} {{ batch.coach.last_name }}</span>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>

            <!-- Sidebar -->
            <div class="program-detail-sidebar">
                <!-- Quick Info Card -->
                <div class="program-info-card">
                    <h3 class="program-info-title">Program Details</h3>
                    <div class="program-info-list">
                        <div class="program-info-item">
                            <span class="info-label">Age Group</span>
                            <span class="info-value">{{ program.age_group|default:"All Ages" }}</span>
                        </div>
                        {% if program.duration %}
                        <div class="program-info-item">
                            <span class="info-label">Duration</span>
                            <span class="info-value">{{ program.duration }}</span>
                        </div>
                        {% endif %}
                        {% if program.sessions_per_week %}
                        <div class="program-info-item">
                            <span class="info-label">Sessions</span>
                            <span class="info-value">{{ program.sessions_per_week }}x per week</span>
                        </div>
                        {% endif %}
                        {% if program.fee_amount %}
                        <div class="program-info-item">
                            <span class="info-label">Fee</span>
                            <span class="info-value highlight">{{ program.fee_amount }}/{{ program.fee_period }}</span>
                        </div>
                        {% endif %}
                    </div>
                    <a href="{% url 'frontend:contact' %}" class="btn btn-primary btn-full">Enroll Now</a>
                </div>

                <!-- Contact Card -->
                <div class="program-contact-card">
                    <h3 class="program-info-title">Need Help?</h3>
                    <p>Have questions about this program? Our team is here to help.</p>
                    <a href="{% url 'frontend:contact' %}" class="btn btn-outline btn-full">Contact Us</a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Other Programs -->
{% if related_programs %}
<section class="section bg-darker">
    <div class="container">
        <div class="section-header">
            <div class="section-tag">Explore More</div>
            <h2 class="section-title">OTHER <span class="text-gradient">PROGRAMS</span></h2>
        </div>
        <div class="programs-grid">
            {% for prog in related_programs %}
            <div class="program-card animate-on-scroll">
                <div class="program-card-image">
                    {% if prog.image %}
                    <img src="{{ prog.image.url }}" alt="{{ prog.name }}" loading="lazy">
                    {% else %}
                    <img src="https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=600&q=80" alt="{{ prog.name }}" loading="lazy">
                    {% endif %}
                    <div class="program-card-overlay">
                        <a href="{% url 'programs:detail' prog.slug %}" class="program-card-btn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M5 12h14M12 5l7 7-7 7"/>
                            </svg>
                        </a>
                    </div>
                </div>
                <div class="program-card-body">
                    <div class="program-card-age">
                        <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                        </svg>
                        {{ prog.age_group|default:"All Ages" }}
                    </div>
                    <h3 class="program-card-title">{{ prog.name }}</h3>
                    <p class="program-card-desc">{{ prog.short_description|default:prog.description|truncatewords:15 }}</p>
                </div>
                <div class="program-card-footer">
                    {% if prog.fee_amount %}
                    <div class="program-card-price">
                        <span class="price-amount">{{ prog.fee_amount }}</span>
                        <span class="price-period">/{{ prog.fee_period }}</span>
                    </div>
                    {% endif %}
                    <a href="{% url 'programs:detail' prog.slug %}" class="btn btn-primary btn-sm">Learn More</a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- CTA -->
<section class="section cta-section">
    <div class="cta-box animate-scale">
        <h2 class="cta-title">READY TO JOIN?</h2>
        <p class="cta-text">Start your football journey with us today</p>
        <div class="cta-buttons">
            <a href="{% url 'frontend:contact' %}" class="btn btn-primary">Contact Us</a>
            <a href="{% url 'programs:list' %}" class="btn btn-outline">View All Programs</a>
        </div>
    </div>
</section>
{% endblock %}
