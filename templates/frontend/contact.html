{% extends 'frontend/base.html' %}
{% load static %}

{% block title %}Contact Us | {{ site_settings.site_name|default:"AIFA Sports Academy" }}{% endblock %}

{% block meta_description %}Get in touch with Altius International Football Academy. Contact us for admissions, inquiries, or to schedule a trial session. We're here to help you start your football journey.{% endblock %}

{% block og_title %}Contact Us | {{ site_settings.site_name|default:"AIFA Sports Academy" }}{% endblock %}
{% block og_description %}Get in touch with AIFA for admissions, inquiries, or to schedule a trial session.{% endblock %}

{% block content %}
<!-- Page Hero -->
<section class="page-hero">
    <div class="page-hero-bg" style="background-image: url('{% if page_settings.hero_image %}{{ page_settings.hero_image.url }}{% else %}https://images.unsplash.com/photo-1517466787929-bc90951d0974?w=1920&q=80{% endif %}');"></div>
    <div class="page-hero-overlay"></div>
    <div class="page-hero-content">
        <h1 class="page-hero-title">{{ page_settings.hero_title|default:"CONTACT <span class='text-gradient'>US</span>"|safe }}</h1>
        <p class="page-hero-text">{{ page_settings.hero_subtitle|default:"Get in touch with us. We'd love to hear from you!" }}</p>
    </div>
</section>

<!-- Contact Section -->
<section class="section">
    <div class="container">
        <div class="contact-grid">
            <!-- Contact Info Cards -->
            <div class="contact-info animate-left">
                <!-- Address Card -->
                {% if site_settings.address %}
                <div class="contact-card contact-card-address">
                    <div class="contact-card-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                            <circle cx="12" cy="10" r="3"/>
                        </svg>
                    </div>
                    <h4>Visit Us</h4>
                    <p>{{ site_settings.address }}</p>
                </div>
                {% endif %}

                <!-- Combined Call & Email Card -->
                {% if site_settings.phone or site_settings.email %}
                <div class="contact-card contact-card-dual">
                    <div class="contact-dual-grid">
                        {% if site_settings.phone %}
                        <div class="contact-dual-item">
                            <div class="contact-card-icon contact-icon-sm">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                </svg>
                            </div>
                            <div class="contact-dual-content">
                                <span class="contact-dual-label">Call Us</span>
                                <a href="tel:{{ site_settings.phone }}" class="contact-dual-value">{{ site_settings.phone }}</a>
                            </div>
                        </div>
                        {% endif %}
                        {% if site_settings.email %}
                        <div class="contact-dual-item">
                            <div class="contact-card-icon contact-icon-sm">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                                    <polyline points="22,6 12,13 2,6"/>
                                </svg>
                            </div>
                            <div class="contact-dual-content">
                                <span class="contact-dual-label">Email Us</span>
                                <a href="mailto:{{ site_settings.email }}" class="contact-dual-value">{{ site_settings.email }}</a>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endif %}

                <!-- Map Card -->
                <div class="contact-card contact-card-map">
                    <div class="contact-map-frame">
                        {% if site_settings.google_maps_embed %}
                        {{ site_settings.google_maps_embed|safe }}
                        {% else %}
                        <iframe
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d125406.69556169882!2d76.2144349!3d10.0104769!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3b080d514abec6bf%3A0xbd582caa5f3f59a!2sKochi%2C%20Kerala!5e0!3m2!1sen!2sin!4v1703342400000!5m2!1sen!2sin"
                            width="100%"
                            height="100%"
                            style="border:0;"
                            allowfullscreen=""
                            loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                        {% endif %}
                    </div>
                    <div class="contact-map-info">
                        <h4>Find Us</h4>
                        {% if site_settings.address %}
                        <p>{{ site_settings.address }}</p>
                        {% endif %}
                        <a href="https://www.google.com/maps/search/?api=1&query={{ site_settings.address|urlencode }}" target="_blank" class="btn btn-sm btn-outline">
                            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="3 11 22 2 13 21 11 13 3 11"/>
                            </svg>
                            Get Directions
                        </a>
                    </div>
                </div>

                <!-- WhatsApp Card -->
                <div class="contact-card contact-card-whatsapp">
                    <div class="contact-card-icon" style="background: #25D366;">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                        </svg>
                    </div>
                    <div class="whatsapp-content">
                        <h4>Chat on WhatsApp</h4>
                        <p>Quick responses during business hours</p>
                        <a href="https://wa.me/{{ site_settings.whatsapp|default:'919876543210'|cut:' '|cut:'+' }}" target="_blank" class="btn btn-whatsapp">
                            <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/>
                            </svg>
                            Start Chat
                        </a>
                    </div>
                </div>
            </div>

            <!-- Contact Form -->
            <div class="contact-form-card animate-right">
                <div class="contact-form-header">
                    <h3>Send us a Message</h3>
                    <p>Fill out the form below and we'll get back to you as soon as possible.</p>
                </div>

                {% if messages %}
                <div class="mb-6">
                    {% for message in messages %}
                    <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                        {{ message }}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <form method="POST" action="{% url 'frontend:contact' %}" class="contact-form">
                    {% csrf_token %}

                    <div class="form-row">
                        <div class="form-group">
                            <label for="id_name" class="form-label">Your Name *</label>
                            <input type="text" name="name" id="id_name" required class="form-input"
                                   value="{{ form.name.value|default:'' }}" placeholder="Enter your name">
                            {% if form.name.errors %}
                            <span class="form-error">{{ form.name.errors.0 }}</span>
                            {% endif %}
                        </div>

                        <div class="form-group">
                            <label for="id_email" class="form-label">Email Address *</label>
                            <input type="email" name="email" id="id_email" required class="form-input"
                                   value="{{ form.email.value|default:'' }}" placeholder="Enter your email">
                            {% if form.email.errors %}
                            <span class="form-error">{{ form.email.errors.0 }}</span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="id_phone" class="form-label">Phone Number</label>
                            <input type="tel" name="phone" id="id_phone" class="form-input"
                                   value="{{ form.phone.value|default:'' }}" placeholder="Enter your phone number">
                            {% if form.phone.errors %}
                            <span class="form-error">{{ form.phone.errors.0 }}</span>
                            {% endif %}
                        </div>

                        <div class="form-group">
                            <label for="id_subject" class="form-label">Subject *</label>
                            <input type="text" name="subject" id="id_subject" required class="form-input"
                                   value="{{ form.subject.value|default:'' }}" placeholder="Enter subject">
                            {% if form.subject.errors %}
                            <span class="form-error">{{ form.subject.errors.0 }}</span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="id_message" class="form-label">Message *</label>
                        <textarea name="message" id="id_message" rows="5" required class="form-textarea"
                                  placeholder="Enter your message">{{ form.message.value|default:'' }}</textarea>
                        {% if form.message.errors %}
                        <span class="form-error">{{ form.message.errors.0 }}</span>
                        {% endif %}
                    </div>

                    <!-- Human Verification - Drag Football to Goal -->
                    <div class="form-group">
                        <label class="form-label">Verify You're Human *</label>
                        <div class="captcha-container" id="captcha-container">
                            <div class="captcha-instruction">
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <path d="M12 16v-4M12 8h.01"/>
                                </svg>
                                <span>Drag the football into the goal to verify</span>
                            </div>
                            <div class="captcha-field">
                                <!-- Football (Draggable) -->
                                <div class="captcha-ball" id="captcha-ball" draggable="true">
                                    <svg viewBox="0 0 100 100" width="50" height="50">
                                        <circle cx="50" cy="50" r="45" fill="#fff" stroke="#000" stroke-width="2"/>
                                        <path d="M50 5 L50 95 M5 50 L95 50" stroke="#000" stroke-width="1.5" opacity="0.3"/>
                                        <path d="M50 5 Q75 25 75 50 Q75 75 50 95 Q25 75 25 50 Q25 25 50 5" fill="none" stroke="#000" stroke-width="1.5"/>
                                        <circle cx="50" cy="50" r="15" fill="none" stroke="#000" stroke-width="1.5"/>
                                        <!-- Pentagon patterns -->
                                        <polygon points="50,20 58,28 55,38 45,38 42,28" fill="#1a1a2e"/>
                                        <polygon points="72,40 78,52 72,62 62,58 62,46" fill="#1a1a2e"/>
                                        <polygon points="28,40 38,46 38,58 28,62 22,52" fill="#1a1a2e"/>
                                        <polygon points="35,70 45,66 55,66 65,70 58,80 42,80" fill="#1a1a2e"/>
                                    </svg>
                                </div>

                                <!-- Goal (Drop Zone) -->
                                <div class="captcha-goal" id="captcha-goal">
                                    <div class="goal-post">
                                        <div class="goal-net"></div>
                                        <div class="goal-frame-top"></div>
                                        <div class="goal-frame-left"></div>
                                        <div class="goal-frame-right"></div>
                                    </div>
                                    <span class="goal-text">DROP HERE</span>
                                </div>
                            </div>

                            <!-- Success State -->
                            <div class="captcha-success" id="captcha-success">
                                <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                    <polyline points="22 4 12 14.01 9 11.01"/>
                                </svg>
                                <span>GOAL! Verification Complete</span>
                            </div>

                            <!-- Hidden input for form validation -->
                            <input type="hidden" name="human_verified" id="human_verified" value="">
                        </div>
                        <span class="form-error captcha-error" id="captcha-error" style="display: none;">Please complete the verification by dragging the football to the goal.</span>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block" id="submit-btn">
                        Send Message
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13"/>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                        </svg>
                    </button>
                </form>
            </div>
        </div>

    </div>
</section>
{% endblock %}
